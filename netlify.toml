[build]
  publish = "public"

[build.environment]
  HUGO_VERSION = "0.83.1"
  HUGO_ENABLEGITINFO = "true"
  GO_VERSION = "1.12"
  NODE_ENV = "development"

[build.processing]
  skip_processing = true

[context.production]
  command = "make assets; hugo --gc --minify --enableGitInfo"
  [context.production.environment]
    HUGO_ENV = "production"

[context.deploy-preview]
  command = "make assets; hugo --gc --minify --enableGitInfo --buildFuture"

[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Content-Security-Policy = "default-src 'self' coudfront.net *.cloudfront.net docs.chef.io apis.google.com googleapis.com swiftype.com *.swiftype.com netlify.app *.netlify.app ; font-src 'self' fontawesome.com fonts.googleapis.com fonts.gstatic.com; img-src 'self' data: fontawesome.com; script-src 'self' netlify-cdp-loader.netlify.app data: filesystem:; style-src 'self' docs.chef.io fonts.googleapis.com netlify.app *.netlify.app"
    Referrer-Policy = "no-referrer-when-downgrade"
    Strict-Transport-Security = "max-age=2592000"
    Permissions-Policy = "vibrate=(), geolocation=(), midi=(), notifications=(), push=(), sync-xhr=(), microphone=(), camera=(), magnetometer=(), gyroscope=(), speaker=(), vibrate=(), fullscreen=(), payment=()"

## redirects traffic from old InSpec docs inspec.io/docs/
## https://docs.netlify.com/routing/redirects/#syntax-for-the-netlify-configuration-file

[[redirects]]
  from = "/inspec/reference/*"
  to = "/inspec/:splat"
  status = 301

[[redirects]]
  from = "/resource_*"
  to = "/resources/:splat"
  status = 301

[[redirects]]
  from = "/inspec_reference.html"
  to = "/inspec/cli"
  status = 301

[[redirects]]
  from = "/plugin_knife_windows.html"
  to = "/workstation/knife_windows/"
  status = 301
