---
name: Chef/Modernize/WindowsRegistryUAC
department: Chef/Modernize
description: |-
  Chef Infra Client 15.0 and later includes a windows_uac resource that should be used to set Windows UAC values instead of setting registry keys directly.

   #### correct
   windows_uac 'Set Windows UAC settings' do
     enable_uac false
     prompt_on_secure_desktop true
     consent_behavior_admins :no_prompt
   end
autocorrection: false
target_chef_version: 15.0+
examples: |2-

  #### incorrect

  ```ruby
  registry_key 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System' do
    values [{ name: 'EnableLUA', type: :dword, data: 0 },
            { name: 'PromptOnSecureDesktop', type: :dword, data: 0 },
            { name: 'ConsentPromptBehaviorAdmin', type: :dword, data: 0 },
           ]
    action :create
  end
  ```
version_added: 5.22.0
enabled: true
excluded_file_paths:
- "/workspace/chef-cookstyle-master/**/metadata.rb"
- "/workspace/chef-cookstyle-master/**/attributes/*.rb"
- "/workspace/chef-cookstyle-master/**/Berksfile"
included_file_paths: 
